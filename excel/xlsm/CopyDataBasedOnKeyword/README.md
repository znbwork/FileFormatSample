### VBA脚本功能总结

这个 VBA 脚本旨在自动化数据整合过程，根据关键词匹配，将特定行从一个工作表复制到另一个工作表。该脚本适用于包含一个 **"Input"** 工作表和一个 **"CopySource"** 工作表的 Excel 文件。

#### 核心功能

该脚本执行以下步骤来整合数据：

1.  **清理**: 在运行之前，它会自动删除 **"Input"** 工作表中所有标有黄色的行。这确保了工作表干净，为新的操作做好了准备，防止之前错误运行的数据干扰新数据。

2.  **关键词匹配**: 脚本从下到上扫描 **"Input"** 工作表，以查找 **"Flg"** 列（G列）中值为 **"sub"** 的行。然后，它会读取相应 **"Keyword"** 单元格（C列）中的关键词。

3.  **多关键词和多行处理**: 脚本能够智能地处理包含多个关键词的单元格，无论这些关键词是用逗号 (`,`) 分隔，还是在同一个单元格中分行显示。

4.  **数据复制**: 对于识别出的每个关键词，脚本会在 **"CopySource"** 工作表中搜索匹配的行。找到匹配项后，它会复制整行，并将其插入到 **"Input"** 工作表中相应的 "sub" 行下方。

5.  **高亮显示**: 所有新复制的行都会被自动标记为黄色，以便于识别。

#### 工作原理：技术概述

该脚本是一个名为 `CopyDataBasedOnKeyword()` 的子程序。它使用嵌套循环来遍历数据：

* 一个**主循环**从最后一行向上处理 **"Input"** 工作表。这是一个关键技术，可以确保在插入新行时不会中断循环的行号。
* 一个**内循环**处理单个 `sub` 行内的所有关键词，并正确管理一个 `insertCount` 变量，以将多个复制的行逐一放置在正确的位置。
* 它使用 `Replace(LCase(Trim(...)), " ", "")` 函数进行稳健的关键词匹配，使脚本能够抵御常见的录入错误，例如多余的空格或不一致的大小写。