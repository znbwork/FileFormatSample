
### VBA 脚本说明：按关键词分类提取数据

这个 VBA 宏 (`CategorizeByKeyword_CustomRange`) 是一个强大且灵活的工具，专为自动化 Excel 中的数据分类和提取任务而设计。它实现了两个关键功能：

1.  **根据特定列的关键词进行分类**：脚本会读取“Input”工作表中 **D 列**中指定行范围的关键词。每个独特的关键词都将成为一个新的工作表的名称，用于存储相关数据。
2.  **提取指定列范围的数据**：对于 D 列中包含关键词的每一行，脚本会从“Input”表中提取您指定列（例如，F 列到 H 列）中的数据，并将其复制到对应的关键词工作表中。

这个脚本特别适用于需要根据某个分类（如产品名称、项目代号或客户ID）来组织大量非结构化数据的场景。

---

### 工作原理详解

该脚本的执行流程分为以下几个步骤：

1.  **定义范围**：脚本开头声明并初始化了四个关键变量：
    * `startRowKeywords` 和 `endRowKeywords`：指定了在 **D 列**中读取关键词的行范围。
    * `startColData` 和 `endColData`：指定了在“Input”表中要提取的**数据列**范围。

2.  **读取关键词**：脚本遍历“Input”工作表中 D 列的指定行。对于每个单元格，它会检查其是否包含多个关键词（以换行符分隔），然后将它们逐一处理。

3.  **动态工作表管理**：对于每个发现的关键词，脚本会执行以下操作：
    * **检查**：首先检查当前工作簿中是否已存在一个同名工作表。
    * **创建**：如果同名工作表不存在，脚本会自动创建一个，并以关键词命名。
    * **定位**：如果工作表已存在，脚本会定位到它的下一行空白单元格，准备粘贴新数据。

4.  **按范围复制数据**：找到对应的目标工作表和行后，脚本会使用 `Range().Copy()` 方法，将您指定的列范围（从 `startColData` 到 `endColData`）的数据作为整体复制，然后粘贴到新工作表的第一列。

5.  **完成提示**：所有数据处理完毕后，一个消息框会弹出，通知您任务已成功完成。

---

### 如何使用

要使用这个脚本，请遵循以下步骤：

1.  **数据准备**：
    * 在您的 Excel 工作簿中，确保有一个名为 **"Input"** 的工作表，其中包含您的原始数据。
    * 将您的分类关键词放置在“Input”表的 **D 列**中。
    * 将您需要提取的数据放置在您计划指定的列中（例如，F 列、G 列和 H 列）。

2.  **设置脚本**：
    * 按 `Alt + F11` 打开 VBA 编辑器。
    * 找到并打开您存放宏代码的模块。
    * 在代码开头，根据您的数据，修改 `startRowKeywords`, `endRowKeywords`, `startColData`, 和 `endColData` 这四个变量的值。

3.  **运行宏**：
    * 回到 Excel 主界面。
    * 按 `Alt + F8`，打开宏对话框。
    * 选择 `CategorizeByKeyword`，然后点击 **“执行”**。

脚本将自动执行所有任务，并为您创建新的、分类好的工作表。
